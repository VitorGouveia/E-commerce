generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id             String    @id
  created_at     Int
  admin          Boolean?  @default(false)
  shadow_ban     Boolean?  @default(false)
  ban            Boolean?  @default(false)
  reason_for_ban String?   @default("")
  token_version  Int       @default(0)
  failed_attemps Int       @default(0)
  confirmed      Boolean?  @default(false)
  ip             String
  name           String
  lastname       String?
  username       String
  userhash       String
  cpf            String?   @unique
  email          String    @unique
  password       String
  address        Address[]
  cart           Cart[]
  payment        Payment[]
  Order          Order[]
}

model Payment {
  id          Int     @id @default(autoincrement())
  user_id     String
  method      String
  card_brand  String?
  card_number String?
  card_month  String?
  card_year   String?
  card_code   String?
  user        User    @relation(fields: [user_id], references: [id])
  Order       Order[]
}

model Address {
  id          Int     @id @default(autoincrement())
  user_id     String
  postal_code String
  city        String
  state       String
  street      String
  number      Int
  user        User    @relation(fields: [user_id], references: [id])
  Order       Order[]
}

model Rating {
  id         Int    @id @default(autoincrement())
  item_id    Int
  average    Int
  one_star   Int
  two_star   Int
  three_star Int
  four_star  Int
  five_star  Int
  message    String
  item       Item   @relation(fields: [item_id], references: [id])
}

model Image {
  id      Int    @id @default(autoincrement())
  item_id Int
  link    String
  item    Item   @relation(fields: [item_id], references: [id])
}

model Cart {
  id      Int    @id @default(autoincrement())
  user_id String
  item_id Int
  user    User   @relation(fields: [user_id], references: [id])
  item    Item   @relation(fields: [item_id], references: [id])
}

model Item {
  id             Int        @id @default(autoincrement())
  created_at     Int
  name           String
  brand          String?
  short_name     String
  description    String
  price          Int
  shipping_price Int
  discount       Int
  category       String
  image          Image[]
  dimension      Dimension?
  rating         Rating[]
  cart           Cart[]
  order          Order[]
  coupon         Coupon[]
}

model Dimension {
  id       Int  @id @default(autoincrement())
  item_id  Int
  weight   Int
  length   Int
  height   Int
  width    Int
  diameter Int
  item     Item @relation(fields: [item_id], references: [id])
}

model Order {
  id              Int     @id @default(autoincrement())
  user_id         String
  address_id      Int
  item_id         Int
  payment_id      Int
  shipping_price  Int
  all_items_price Int
  payment         Payment @relation(fields: [payment_id], references: [id])
  address         Address @relation(fields: [address_id], references: [id])
  user            User    @relation(fields: [user_id], references: [id])
  item            Item    @relation(fields: [item_id], references: [id])
}

model Coupon {
  id          Int    @id @default(autoincrement())
  item_id     Int
  code        String
  expire_date Int
  value       Int
  item        Item   @relation(fields: [item_id], references: [id])
}
